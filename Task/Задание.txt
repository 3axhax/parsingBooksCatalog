Задание:
Есть файл import.xml с книгами (стоит учитывать что размер файла может быть очень большой)

Есть база данных MS SQL с таблицами:
books - id int, isbn nvarchar(255), ean nvarchar(13), name nvarchar(255), description ntext, netto money, brutto money, language int, series int, code nvarchar(255)
language - id int, name nvarchar(255)
series - id int, name nvarchar(255)

Нужно прочитать данные и создать записи в таблице для отсутствующих книг или обновить пустые поля для тех, которые уже есть в базе. Поиск книг следует вести по ean.

Соотношение полей:
isbn - тег isbn, при загрузке следует оставлять только цифры и знак "-", а также проверять контрольную цифру (EAN13) и заменять если она не правильная.
ean - только цифры из тега isbn, с правильной контрольной цифрой.
name - тег name
description - тег description
netto - тег price
brutto - netto + 10%, округленное до ближайшего целого
language - Ссылка на запись в таблице language найденую по значению тега language либо вновь созданную
series - Ссылка на запись в таблице series найденую по значению тега param с атрибутом name="Серия" либо вновь созданную
code - значение атрибута id тега book

Разработку следует вести с учетом возможности максимально легкой адаптации скрипта при изменении формата файла с данными (например txt или xls вместо xml)

Должна быть возможность запуска и из командной строки и из веб-интерфейса. В пользовательском интерфейсе следует сделать возможность выбора файла и информирование пользователя о результатах обработки (добавлено - 1, обновлено - 2, ошибки).
